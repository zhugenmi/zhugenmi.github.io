---
title: GDB使用方法
author: zhugenmi
date: 2024-11-14 16:00 +0800
categories: [Systematic Capacity]
tags: [gdb]
description: 
---

## gdb调试

| 命令                    | 说明                                                   |
| ----------------------- | ------------------------------------------------------ |
| **run**                 | **开始执行程序，直到下一个断点或程序结束**             |
| **quit**                | **退出 GDB 调试器**                                    |
| kill                    | 停止程序                                               |
| **break func**          | **在函数func入口处设置断点**                           |
| break *0x400540         | 在地址0x400540处设置断点                               |
| **delete 1**            | **删除断点1**                                          |
| delete                  | 删除所有断点                                           |
| **stepi**               | **执行1条指令**                                        |
| stepi 4                 | 执行4条指令，如果是函数调用则进入函数                  |
| **nexti**               | **执行下一条指令，但以函数调用为单位，不进入函数内部** |
| **continue**            | **从当前位置继续执行程序，直到下一个断点或程序结束**   |
| finish                  | 运行到当前函数返回                                     |
| **disas**               | **反汇编当前函数或指定的代码区域**                     |
| disas func              | 反汇编函数func                                         |
| disas 0x400540          | 反汇编位于地址0x400540附近的函数                       |
| disas 0x400540,0x40054d | 反汇编指定地址范围内的代码                             |
| **print**               | **打印变量的值**                                       |
| print/x $rip            | 以十六进制输出程序计数器的值                           |
| **x**                   | **打印内存中的值**                                     |
| **layout asm**          | **显示汇编代码视图**                                   |
| **layout regs**         | **显示当前的寄存器状态和它们的值**                     |

一般启动 `gdb bomb` 后，首先使用 `layout asm`、`layout regs` 开启视图，方便分析。关闭 `layout` 的方式为：按下 `Ctrl + x`，然后再按下 `a`。

关于 `p` 和 `x`，最重要的就是记得 `p` 命令用于打印表达式或变量的值，而 `x` 命令则主要用于检查内存的内容。几个常用示例如下：

```bash
p $rax  # 打印寄存器 rax 的值
p $rsp  # 打印栈指针的值
p/x $rsp  # 打印栈指针的值，以十六进制显示
p/d $rsp  # 打印栈指针的值，以十进制显示

x/2x $rsp  # 以十六进制格式查看栈指针 %rsp 指向的内存位置 M[%rsp] 开始的两个单位。
x/2d $rsp # 以十进制格式查看栈指针 %rsp 指向的内存位置 M[%rsp] 开始的两个单位。
x/s $rsp # 把栈指针指向的内存位置 M[%rsp] 当作字符串来查看。
x/g $rsp + 4*$rdx # 查看从栈指针 %rsp 加上 %rdx 寄存器值的 4 倍开始的内存位置 M[%rsp + 4*%rdx] 的值，以giant（8字节）单位。
x/20c $rsp # 以字符格式查看栈指针 %rsp 指向的内存位置 M[%rsp] 开始的 20 个单位，即查看 20 个字符。

info registers  # 打印所有寄存器的值
info breakpoints  # 打印所有断点的信息
info frame	#有关当前栈帧的信息

delete breakpoints 1  # 删除第一个断点，可以简写为 d 1
```

这些命令在 `/` 后面的后缀（如 `2x`、`2d`、`s`、`g`、`20c`）指定了查看内存的方式和数量。具体来说：

- 第一个数字（如 `2`、`20`）指定要查看的单位数量。

- 第二个字母（如 `x`、`d`、`s`、`g`、`c`）指定单位类型和显示格式，其中：

- - `x` 代表十六进制。
  - `d` 代表十进制。
  - `s` 代表字符串。
  - `g` 代表 giant，即 8 字节。
  - `c` 代表字符。

