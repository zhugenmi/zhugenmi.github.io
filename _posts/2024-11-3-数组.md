---
title: 数组
author: zhugenmi
date: 2024-11-3 17:20 +0800
categories: [C/C++, C语言编程]
tags: [c]
description: 
---

## 声明数组

所有的数组都是由连续的内存位置组成。最低的地址对应第一个元素，最高的地址对应最后一个元素。

在C中要声明一个数组，需要指定元素的类型和元素的数量，如下所示：

```c
type arrayName [ arraySize ];
```

这叫做一维数组。arraySize 必须是一个大于零的整数常量，type 可以是任意有效的 C 数据类型。

也可以声明一个二维数组：

```c
type arrayName [row_size][col_size];
```

## 初始化数组

在C中，可以逐个初始化数组，也可以使用一个初始化语句，如下所示：

```c
double balance[5] = {1000.0, 2.0, 3.4, 7.0, 50.0};
```

> 大括号 { } 之间的值的数目不能大于我们在数组声明时在方括号 [ ] 中指定的元素数目。如果省略掉了数组的大小，数组的大小则为初始化时元素的个数。

## 访问数组元素

数组元素可以通过数组名称加索引进行访问。元素的索引是放在方括号内，跟在数组名称的后边。

例如访问数组中第十个元素：

```c
double salary = balance[9];
```

## 数组详解

下面列出了 C 程序员必须清楚的一些与数组相关的重要概念：

| 概念           | 描述                                                         |
| -------------- | ------------------------------------------------------------ |
| 多维数组       | C 支持多维数组。多维数组最简单的形式是二维数组。             |
| 传递数组给函数 | 可以通过指定不带索引的数组名称来给函数传递一个指向数组的指针。 |
| 从函数返回数组 | C 允许从函数返回数组。                                       |
| 指向数组的指针 | 可以通过指定不带索引的数组名称来生成一个指向数组中第一个元素的指针。 |

### 多维数组

C 语言支持多维数组。多维数组声明的一般形式如下：

```c
type name[size1][size2]...[sizeN];
```

多维数组最简单的形式是二维数组。一个二维数组，在本质上，是一个一维数组的列表。声明一个 x 行 y 列的二维整型数组，形式如下：

```c
type arrayName [ x ][ y ];
```

其中，type 可以是任意有效的 C 数据类型，arrayName 是一个有效的 C 标识符。一个二维数组可以被认为是一个带有 x 行和 y 列的表格。

多维数组可以通过在括号内为每行指定值来进行初始化。下面是一个带有 3 行 4 列的数组:

```c
int a[3][4] = {
	{0, 1, 2, 3} , /* 初始化索引号为 0 的行 */
	{4, 5, 6, 7} , /* 初始化索引号为 1 的行 */
	{8, 9, 10, 11} /* 初始化索引号为 2 的行 */
};
```

内部嵌套的括号是可选的，下面的初始化与上面是等同的：

```c
int a[3][4] = {0,1,2,3,4,5,6,7,8,9,10,11};
```

### 传递数组给函数

如果想要在函数中传递一个一维数组作为参数，必须以下面三种方式来声明函数形式参数，这三种声明方式的结果是一样的，因为每种方式都会告诉编译器将要接收一个整型指针。同样地，你也可以传递一个多维数组作为形式参数。

1、形式参数是一个指针：

```c
void myFunction(int *param)
{
	...
}
```

2、形式参数是一个已定义大小的数组：

```c
void myFunction(int param[10])
{
	...
}
```

3、形式参数是一个未定义大小的数组：

```c
void myFunction(int param[])
{
    ...
}
```

### 从函数返回数组

C 语言不允许返回一个完整的数组作为函数的参数。但是，可以通过指定不带索引的数组名来返回一个指向数组的指针。

如果想要从函数返回一个一维数组，必须声明一个返回指针的函数，如下：

```c
int * myFunction()
{
	...
}
```

> C 不支持在函数外返回局部变量的地址，除非定义局部变量为 static 变量。

示例：

```c
#include <stdio.h>
/* 生成 10 个随机数，并使用数组来返回它们 */
int * getRandom( )
{
	static int r[10];
	int i;
	/* 设置种子 */
	srand( (unsigned)time( NULL ) );
	for ( i = 0; i < 10; ++i)
	{
		r[i] = rand();
		printf( "r[%d] = %d\n", i, r[i]);
	}
	return r;
}
/* 要调用上面定义函数的主函数 */
int main ()
{
	/* 一个指向整数的指针 */
	int *p;
	int i;
	p = getRandom();
    for ( i = 0; i < 10; i++ )
	{
		printf( "*(p + %d) : %d\n", i, *(p + i));
	}
	return 0;
}
```

### 指向数组的指针

数组名是一个指向数组中第一个元素的常量指针。例如：

```c
double *p;
double balance[10];
p = balance;
```

使用数组名作为常量指针是合法的，反之亦然。因此，`*(balance + 4)` 是一种访问 `balance[4]` 数据的合法方式。一旦你把第一个元素的地址存储在 `p` 中，你就可以使用 `*p`、`*(p+1)`、`*(p+2)` 等来访问数组元素。

## 字符数组与字符串

用来存放字符的数组称为字符数组，例如：

```c
char a[10]; //一维字符数组
char b[5][10]; //二维字符数组
char c[20]={'c', ' ', 'a', 'b', 'c', 'd', 'e', 'f','g'}; // 给部分数组元素赋值
char d[]={'c', ' ', 'a', 'b', 'c', 'd', 'e', 'f','g' }; //对全体元素赋值时可以省去长度
```

字符数组实际上是一系列字符的集合，也就是字符串（`String`）。在C语言中，没有专门的字符串变量，没有`string`类型，通常就用一个字符数组来存放一个字符串。

C语言规定，**可以将字符串直接赋值给字符数组**，例如：

```c
char str[30] = {"1234567890"};
```

或者：

```c
char str[30] = "1234567890"; //这种形式更加简洁，实际开发中常用
```

也可以不指定数组长度，例如：

```c
char str[] = {"1234567890"};
char str[] = "1234567890"; //这种形式更加简洁，实际开发中常用
```

在C语言中，字符串总是以`'\0'`作为串的结束符。上面的两个字符串，编译器已经在末尾自动添加了`'\0'`。

>  '\0'是ASCII码表中的第0个字符，用NULL表示，称为空字符。该字符既不能显示，也不是控制字符，输出该字符不会有任何效果，它在C语言中仅作为字符串的结束标志。

需要注意的是，用字符串给字符数组赋值时由于要添加结束符 `'\0'`，数组的长度要比字符串的长度（字符串长度不包括` '\0'`）大1。例如：

```c
char str[] = "C program";
```

该数组在内存中的实际存放情况为：字符串长度为 9，数组长度为 10。

## C语言字符串处理函数

C语言提供了丰富的字符串处理函数，例如：字符串的输入、输出、合并、修改、比较、转换、复制、搜索等，使用这些现成的函数可大大减轻编程的负担。

用于输入输出的字符串函数，例如`printf`、`puts`、`scanf`、`gets`等，使用时应包含头文件`stdio.h`，使用其它字符串函数则应包含头文件`string.h`。

### 字符串长度函数 strlen

用来获得字符串的长度，就是包含多少个字符（不包括字符串结束标志 `'\0'`）。语法格式：

```c
strlen(arrayName);
```

需要说明的是，`strlen `会从字符串的第 0 个字符开始计算，直到遇到字符串结束标志 `'\0'`。例如，对于以下字符串：

```c
char str[]="C \0language";
```

对应`strlen(str)`的结果为2。

### 字符串连接函数 strcat

把两个字符串拼接在一起，语法格式为：

```c
strcat(arrayName1, arrayName2);
```

`strcat `将把 `arrayName2 `连接到 `arrayName1 `后面，并删去 `arrayName1 `最后的结束标志 `'\0'`。这就意味着，`arrayName1` 的长度要足够，必须能够同时容纳 `arrayName1 `和 `arrayName2`，否则会越界。

`strcat `返回值为 `arrayName1 `的首地址。

示例：

```c
#include <stdio.h>
#include <string.h>
int main(){
	char str1[40]="My name is ";
	char str2[20];
	printf("Input your name:");
	gets(str2);
	strcat(str1,str2);
	puts(str1);
	return 0;
}
```

运行结果：

```bash
Input your name:Gin Li
My name is Gin Li
```

### 字符串复制函数 strcpy

语法格式为：

```c
strcpy(arrayName1, arrayName2);
```

`strcpy `会把 `arrayName2 `中的字符串拷贝到 `arrayName1 `中，字符串结束标志` '\0'` 也一同拷贝。

> strcat 要求 arrayName1 要有足够的长度，否则不能全部装入所拷贝的字符串。

### 字符串比较函数

语法格式为：

```c
strcmp(arrayName1, arrayName2);
```

`arrayName1 `和 `arrayName2 `是需要比较的两个字符串。字符本身没有大小之分，`strcmp()` 以各个字符对应的 ASCII 码值进行比较。`strcmp() `从两个字符串的第 0 个字符开始比较，如果它们相等，就继续比较下一个字符，直到遇见不同的字符，或者到字符串的末尾。

返回值：

- 若 `arrayName1 `和 `arrayName2 `相同，则返回0；
- 若 `arrayName1 `大于 `arrayName2`，则返回大于 0 的值；
- 若 `arrayName1 `小于 `arrayName2`，则返回小于0 的值。

示例：

```c
#include <stdio.h>
#include <string.h>
int main(){
	char *a = "aBcDeF";
	char *b = "AbCdEf";
	char *c = "aacdef";
	char *d = "aBcDeF";
    printf("strcmp(a, b) : %d\n", strcmp(a, b));
	printf("strcmp(a, c) : %d\n", strcmp(a, c));
	printf("strcmp(a, d) : %d\n", strcmp(a, d));
	return 0;
}
```

运行结果：

```bash
strcmp(a, b) : 1
strcmp(a, c) : -1
strcmp(a, d) : 0
```

## C语言字符串的输入输出

### 字符串的输出

在C语言中，输出字符串的函数有两个：

```c
int puts(const char *s);
int printf(const char *format, ...);
```

`puts()`：直接输出字符串，并且只能输出字符串。

`printf()`：通过格式控制符 `%s` 输出字符串。除了字符串，`printf()` 还能输出其他类型的数据。

> 在`printf() `函数中使用%s输出字符串时，在变量列表中给出数组名即可，不能写为`printf("%s", str[]);`。

### 字符串的输入

在C语言中，输入字符串的函数有两个：

```c
char *gets(char *s);
int scanf(const char *format, ...);
```

`gets()`：直接输入字符串，并且只能输入字符串。

`scanf()`：通过格式控制符` %s` 输入字符串。除了字符串，`scanf()` 还能输入其他类型的数据。

### 使用 scanf() 读取字符串

前面讲`scanf` 函数时讲到，从键盘上读取数据时，各个变量前面要加取地址符`&`，用以获得变量的地址。例如：

```c
int a, b;
scanf("%d %d", &a, &b);
```

但是将字符串读入字符数组没有使用`&`：

```c
char str1[20], str2[20], str3[20], str4[20];
scanf("%s %s %s %s",str1, str2, str3, str4);
```

这是因为C语言规定，数组名就代表了该数组的地址。整个数组是一块连续的内存单元。

数组名所代表的地址为第0个元素的地址，例如`char c[10];`，`c`就代表`c[0]`的地址。第0个元素的地址就是数组的起始地址，称为首地址。也就是说，**数组名表示数组的首地址**。

> printf 函数会根据数组名找到c的首地址，然后逐个输出数组中各个字符直到遇到 '\0' 为止。

### 使用 gets() 读取字符串

该函数获取用户从键盘输入的字符串，原型为：

```c
char *gets(char *s);
```

`gets()` 函数不会把空格作为输入结束的标志，而只把回车换行作为输入结束的标志，这与 `scanf()` 函数是不同的。

总结：**如果希望读取的字符串中不包含空格，那么使用 `scanf()` 函数；如果希望获取整行字符串，那么使用 `gets()` 函数，它能避免空格的截断。**

